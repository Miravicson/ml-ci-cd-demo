language: generic
env:
  global:
    - CI=true
    - PATH=$HOME/google-cloud-sdk/bin:$HOME/anaconda3/bin:$PATH
cache:
  directories:
    - $HOME/google-cloud-sdk
    - $HOME/anaconda3
    - $HOME/anaconda3_installer
    - $HOME/anaconda3/envs/ml-ci-cd-demo
before_install:
  - echo "listing conda dir"; ls $HOME/anaconda3/bin
  - if [[ -f $HOME/anaconda3/bin/conda ]]; then echo "[INFO] OK Found conda!"; fi
  - ./setup.sh
jobs:
  include: 
    - stage: train model
      script:
      - ./bin/get_data.sh
      - ./bin/train.sh scikit-model
#       - echo "initiate model statistical tests"
#       - echo "deploying model"
#     - stage: staging smoke test
#       script: echo "running smoke test"
#     - stage: deploy model to production
#       if: branch = deploy-to-prod
#       script: echo "initiate deploy-to-prod job"
#     - stage: smoke test for production
#       if: branch = deploy-to-prod
#       script: echo "running smoke test"
