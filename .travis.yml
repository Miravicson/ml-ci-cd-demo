language: generic
env:
  - PATH=$HOME/google-cloud-sdk/bin:$HOME/anaconda3/bin:$PATH
cache:
  directories:
    - $HOME/google-cloud-sdk
    - $HOME/anaconda3
    - $HOME/anaconda3_installer
  timeout: 1000 # 1000 secs, or ~16 minutes
before_install:
  - ./setup.sh
jobs:
  include: 
    - stage: train model
      script:
      - ./bin/get_data.sh
      - ./bin/train.sh scikit-model
      - echo 'placeholder: running statistical tests on model'
    - stage: deploy model
      script:
      - ./bin/deploy.sh scikit-model
#     - stage: staging smoke test
#       script: echo "running smoke test"
#     - stage: deploy model to production
#       if: branch = deploy-to-prod
#       script: echo "initiate deploy-to-prod job"
#     - stage: smoke test for production
#       if: branch = deploy-to-prod
#       script: echo "running smoke test"
